<div class="form-container">
    <form class="large-form" action="/text/create" method="post">
        <div class="field">
            <div class="element">
                <input class="element-input" type="text" placeholder="URL" autofocus name="url" data-url-el />
            </div>
        </div>
        <div class="separator"><span>or</span></div>
        <div class="field">
            <div class="element">
                <input class="element-input" type="text" placeholder="Title" name="title" data-title-el />
            </div>
        </div>
        <div class="field">
            <div class="element">
                <div class="element-editor" data-content-editor-el></div>
                <textarea style="display:none;" class="element-textarea" placeholder="Text" name="content" data-content-el></textarea>
            </div>
        </div>
        <div class="control">
            <input class="button" type="submit" value="Add" />
            <a class="button simple-button" href="/text/index">Cancel</a>
        </div>
    </form>
</div>

<link rel="stylesheet" href="/js/jquery-notebook/src/js/jquery.notebook.css" />
<script src="/js/jquery-notebook/src/js/jquery.notebook.js"></script>

<script>

(function() {

$.fn.notebook.defaults = {
    autoFocus: false,
    placeholder: 'Text',
    mode: 'multiline', // multiline or inline
    modifiers: ['bold', 'italic', 'underline', 'h1', 'h2', 'ol', 'ul', 'anchor']
};

var urlEl = $('[data-url-el]'),
    titleEl = $('[data-title-el]'),
    contentEl = $('[data-content-el]');
    contentEditorEl = $('[data-content-editor-el]');

contentEditorEl.notebook();

// Editor
contentEditorEl.on('contentChange', function(e) {
  contentEl.val(contentEditorEl.html());
});

// Url
urlEl.on('change', function() {
  var url = this.value;

  $.get('/text/parse?url='+url).done(function(data) {
    if (! data.error) {
      if (data.title) {
        titleEl.val(data.title);
      }

      if (data.contents) {
        contentEl.val(data.contents);
        contentEditorEl.html(data.contents);
      }
    }
  });
});

})();

</script>